# Railway Setup Instructions

## Проблема: "DATABASE_URL or database connection variables must be set"

Эта ошибка возникает, когда PostgreSQL база данных не подключена к вашему web-сервису в Railway.

## Решение

### Шаг 1: Проверьте, что PostgreSQL добавлен в проект

1. Откройте ваш Railway проект
2. Убедитесь, что есть сервис PostgreSQL (зеленая иконка базы данных)
3. Если PostgreSQL нет - добавьте его:
   - Нажмите "New" → "Database" → "Add PostgreSQL"

### Шаг 2: Убедитесь, что оба сервиса в одном проекте

- Web-сервис (ваше Django приложение)
- PostgreSQL сервис

Оба должны быть в **одном и том же Railway проекте**.

### Шаг 3: Проверьте переменные окружения

1. Откройте ваш **web-сервис** (не PostgreSQL!)
2. Перейдите в раздел "Variables"
3. Проверьте, что есть переменная `DATABASE_URL`
   - Railway должен установить её автоматически
   - Формат: `postgresql://user:password@host:port/database`

### Шаг 4: Если DATABASE_URL отсутствует

#### Вариант A: Автоматическая настройка (рекомендуется)

1. Убедитесь, что PostgreSQL сервис запущен
2. В Railway проекте, нажмите на PostgreSQL сервис
3. Перейдите в "Connect" или "Variables"
4. Найдите `DATABASE_URL` или параметры подключения
5. Скопируйте `DATABASE_URL`
6. Перейдите в ваш web-сервис → Variables
7. Добавьте новую переменную:
   - **Name**: `DATABASE_URL`
   - **Value**: вставьте скопированное значение

#### Вариант B: Ручная настройка

Если Railway не передает `DATABASE_URL` автоматически:

1. Откройте PostgreSQL сервис → "Connect"
2. Скопируйте параметры подключения:
   - Host
   - Port
   - Database
   - User
   - Password
3. Создайте `DATABASE_URL` в формате:
   ```
   postgresql://USER:PASSWORD@HOST:PORT/DATABASE
   ```
4. Добавьте эту переменную в ваш web-сервис

### Шаг 5: Перезапустите сервис

После добавления `DATABASE_URL`:
1. Railway автоматически перезапустит сервис
2. Или нажмите "Redeploy" вручную

### Шаг 6: Проверьте логи

После перезапуска проверьте логи:
- Должны увидеть успешное выполнение миграций
- Не должно быть ошибок подключения к базе данных

## Альтернатива: Использование отдельных переменных

Если `DATABASE_URL` не работает, можно использовать отдельные переменные:

В web-сервисе добавьте:
- `PGHOST` - хост базы данных
- `PGDATABASE` - имя базы данных
- `PGUSER` - пользователь
- `PGPASSWORD` - пароль
- `PGPORT` - порт (обычно 5432)

## Проверка

После настройки, ваше приложение должно:
1. ✅ Успешно подключиться к базе данных
2. ✅ Выполнить миграции
3. ✅ Запуститься без ошибок

## Дополнительная помощь

Если проблема сохраняется:
1. Проверьте логи Railway для деталей ошибки
2. Убедитесь, что PostgreSQL сервис запущен
3. Проверьте, что оба сервиса в одном проекте
4. Попробуйте пересоздать связь между сервисами

